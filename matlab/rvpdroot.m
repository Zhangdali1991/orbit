function px=rvpdroot(rvec,vvec,a,e,i,omega,E)
x=rvec(1);
y=rvec(2);
z=rvec(3);
x1=vvec(1);
y1=vvec(2);
z1=vvec(3);
r=norm(rvec);
n=1/sqrt(a^3);
p=a*(1-e^2);
H=-a/p*(cos(E)+e);
K=sin(E)/n*(1+r/p);
H1=sqrt(a)*sin(E)/(r*p)*(1-a/r*(1+p/r));
K1=a/p*cos(E);
rda=rvec/a;
rde=H*rvec+K*vvec;
rdi=[z*sin(omega);-z*cos(omega);y*cos(omega)-x*sin(omega)];
rdomega=[-y;x;0];
rdw=[-z*cos(omega)*sin(i)-y*cos(i);x*cos(i)-z*sin(omega)*sin(i);y*sin(omega)*sin(i)+x*cos(omega)*sin(i)];
rdtou=-vvec;
vda=-1/(2*a)*vvec;
vde=H1*rvec+K1*vvec;
vdi=[z1*sin(omega);-z1*cos(omega);y1*cos(omega)-x1*sin(omega)];
vdomega=[-y1;x1;0];
vdw=[-z1*cos(omega)*sin(i)-y1*cos(i);x1*cos(i)-z1*sin(omega)*sin(i);y1*sin(omega)*sin(i)+x1*cos(omega)*sin(i)];
vdtou=rvec/r^3;
px=[rda,rde,rdi,rdomega,rdw,rdtou;vda,vde,vdi,vdomega,vdw,vdtou;];
end